# ROADMAP

## Текущая задача: Создание системы перевода с автоматической историей

**Цель**: Создать кнопку перевода текста, реализовать систему многоязычности с разными директориями (/de) для SEO, основной сайт на русском языке, интегрировать автоматическую историю

### Этап 1: Анализ и подготовка

- [ ] **Анализ текущей системы интернационализации**
  - Изучить существующие файлы переводов в `/lang/`
  - Проанализировать текущую структуру языковых файлов (de.json, en.json, ru.json)
  - Проверить интеграцию с `integrations/i18n.php`
  - Оценить текущую реализацию переключения языков
  - Сделать скриншот текущего состояния

- [ ] **Проектирование архитектуры многоязычности**
  - Определить структуру URL для разных языков:
    - `/` - основной язык (русский)
    - `/de/` - немецкий язык
    - `/en/` - английский язык
  - Спроектировать систему маршрутизации
  - Определить структуру файлов для каждого языка
  - Спланировать SEO-оптимизацию (hreflang, sitemap)

### Этап 2: Создание системы маршрутизации

- [ ] **Создание .htaccess для многоязычности**
  - Создать правила перенаправления для языковых URL
  - Настроить обработку `/de/` и `/en/` маршрутов
  - Добавить правила для статических ресурсов
  - Обеспечить корректную работу без языкового префикса

- [ ] **Реализация функций маршрутизации**
  - Создать функцию `detect_language_from_url()`
  - Реализовать функцию `get_current_language()`
  - Создать функцию `get_language_url($lang, $path)`
  - Добавить функцию редиректа на правильную языковую версию

### Этап 3: Создание языковых директорий

- [ ] **Создание директории /de/**
  - Создать `/de/index.php` (главная страница)
  - Создать `/de/about.php` (о компании)
  - Создать `/de/services.php` (услуги)
  - Создать `/de/portfolio.php` (портфолио)
  - Создать `/de/blog.php` (блог)
  - Создать `/de/contact.php` (контакты)
  - Настроить правильные пути для ресурсов

- [ ] **Создание директории /en/**
  - Создать `/en/index.php` (главная страница)
  - Создать `/en/about.php` (о компании)
  - Создать `/en/services.php` (услуги)
  - Создать `/en/portfolio.php` (портфолио)
  - Создать `/en/blog.php` (блог)
  - Создать `/en/contact.php` (контакты)
  - Настроить правильные пути для ресурсов

### Этап 4: Реализация кнопки перевода

- [ ] **Создание компонента кнопки перевода**
  - Создать функцию `render_language_switcher()` в `ux/components.php`
  - Добавить HTML структуру кнопки с флагами
  - Реализовать CSS стили для кнопки перевода
  - Добавить анимации и hover эффекты

- [ ] **JavaScript функциональность**
  - Создать `assets/js/language-switcher.js`
  - Реализовать переключение языков без перезагрузки страницы
  - Добавить сохранение выбранного языка в localStorage
  - Реализовать автоматическое определение языка браузера

- [ ] **Интеграция кнопки в сайт**
  - Добавить кнопку в `ux/layout.php` (header)
  - Интегрировать во все страницы сайта
  - Добавить кнопку в мобильное меню
  - Обеспечить корректное отображение на всех устройствах

### Этап 5: Обновление языковых файлов

- [ ] **Расширение файлов переводов**
  - Обновить `/lang/ru.json` (основной язык)
  - Обновить `/lang/de.json` (немецкий)
  - Обновить `/lang/en.json` (английский)
  - Добавить переводы для всех текстов сайта
  - Создать переводы для админ-панели

- [ ] **Система загрузки переводов**
  - Обновить `integrations/i18n.php`
  - Реализовать функцию `load_translations($lang)`
  - Добавить кэширование переводов
  - Создать функцию `t($key, $params = [])` для переводов

### Этап 6: Создание системы автоматической истории

- [ ] **Создание таблицы истории переводов**
  - Создать таблицу `translation_history` в БД
  - Поля: id, content_type, content_id, language, field_name, old_value, new_value, user_id, created_at
  - Добавить индексы для оптимизации запросов
  - Создать таблицу `translation_versions` для версионирования

- [ ] **Система отслеживания изменений**
  - Создать функцию `track_translation_change()`
  - Интегрировать в функции сохранения контента
  - Добавить автоматическое сохранение истории при редактировании
  - Реализовать отслеживание изменений в админке

- [ ] **Интерфейс управления историей**
  - Создать страницу `admin/translation_history.php`
  - Реализовать просмотр истории изменений
  - Добавить фильтрацию по языкам и типам контента
  - Создать функцию отката к предыдущим версиям

### Этап 7: Интеграция с существующими компонентами

- [ ] **Обновление layout и компонентов**
  - Модифицировать `ux/layout.php` для поддержки многоязычности
  - Обновить `ux/data.php` для языковых версий
  - Интегрировать переводы во все компоненты
  - Обновить админ-панель для работы с переводами

- [ ] **Обновление страниц**
  - Адаптировать все основные страницы для работы с переводами
  - Обновить формы для многоязычности
  - Интегрировать переводы в блог и портфолио
  - Обеспечить корректную работу на всех языках

### Этап 8: SEO-оптимизация

- [ ] **Hreflang теги**
  - Добавить hreflang теги в HTML head
  - Реализовать автоматическую генерацию hreflang
  - Обеспечить правильные ссылки между языковыми версиями

- [ ] **Многоязычный sitemap**
  - Создать `sitemap-multilang.xml`
  - Добавить все языковые версии страниц
  - Обновить `seo/sitemap.php` для поддержки многоязычности

- [ ] **Дополнительные SEO элементы**
  - Обновить robots.txt для разных языков
  - Добавить языковые мета-теги
  - Реализовать канонические URL для каждой языковой версии

### Этап 9: Тестирование и оптимизация

- [ ] **Тестирование функциональности**
  - Протестировать переключение языков
  - Проверить корректность отображения переводов
  - Тестировать SEO-элементы (hreflang, sitemap)
  - Проверить работу на разных устройствах

- [ ] **Тестирование производительности**
  - Проверить скорость загрузки многоязычных страниц
  - Оптимизировать загрузку переводов
  - Протестировать кэширование
  - Проверить работу системы истории

### Этап 10: Создание скриншотов и документации

- [ ] **Скриншоты для удостоверения**
  - Скриншот кнопки перевода на сайте
  - Скриншоты разных языковых версий страниц
  - Скриншот SEO-элементов (hreflang)
  - Скриншот многоязычного sitemap
  - Скриншот системы автоматической истории
  - Скриншот админки управления переводами

- [ ] **Документация**
  - Создать документацию по использованию системы переводов
  - Задокументировать API для разработчиков
  - Создать руководство по добавлению новых языков

## Технические детали

### Структура URL:
- `https://baumaster.de/` - русский (основной)
- `https://baumaster.de/de/` - немецкий
- `https://baumaster.de/en/` - английский

### Файловая структура:
```
/
├── de/
│   ├── index.php
│   ├── about.php
│   ├── services.php
│   └── ...
├── en/
│   ├── index.php
│   ├── about.php
│   ├── services.php
│   └── ...
├── lang/
│   ├── de.json
│   ├── ru.json
│   └── en.json
└── translations/
    ├── history/
    │   ├── de/
    │   ├── en/
    │   └── ru/
    └── cache/
```

### SEO элементы:
- Hreflang теги для указания языковых версий
- Многоязычный sitemap.xml
- Канонические URL для каждой языковой версии
- Языковые мета-теги

## Файлы для создания/модификации

### Новые файлы:
- `.htaccess` - маршрутизация многоязычных URL
- `/de/index.php`, `/de/about.php`, etc. - немецкие версии
- `/en/index.php`, `/en/about.php`, etc. - английские версии
- `sitemap-multilang.xml` - многоязычный sitemap
- `translations/history/` - директория для истории переводов
- `assets/js/language-switcher.js` - JavaScript для переключения языков
- `admin/translation_history.php` - управление историей переводов

### Модифицируемые файлы:
- `ux/components.php` - кнопка перевода
- `ux/layout.php` - поддержка многоязычности
- `ux/data.php` - языковые данные
- `integrations/i18n.php` - система переводов
- `lang/*.json` - файлы переводов
- `seo/sitemap.php` - многоязычный sitemap
- `database.php` - таблицы для истории переводов

## Языки для поддержки

1. **Русский (ru)** - основной язык
2. **Немецкий (de)** - для немецкоязычных клиентов
3. **Английский (en)** - для международных клиентов

## Приоритеты реализации

1. **Высокий приоритет**: Основная функциональность перевода
2. **Высокий приоритет**: Система автоматической истории
3. **Средний приоритет**: SEO-оптимизация
4. **Средний приоритет**: Дополнительные языки
5. **Низкий приоритет**: Расширенные функции

## Этапы выполнения

### Этап 1: Подготовка (1-2 дня)
- Анализ текущей системы
- Проектирование архитектуры
- Создание языковых директорий

### Этап 2: Основная функциональность (2-3 дня)
- Система маршрутизации
- Кнопка перевода
- Обновление языковых файлов

### Этап 3: Система истории (2-3 дня)
- Создание таблиц БД
- Система отслеживания изменений
- Интерфейс управления историей

### Этап 4: Интеграция (2-3 дня)
- Интеграция с существующими компонентами
- SEO-оптимизация
- Тестирование

### Этап 5: Финальная проверка (1-2 дня)
- Тестирование всех функций
- Создание скриншотов
- Документация

**Общее время выполнения**: 8-13 дней